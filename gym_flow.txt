전체 흐름 (Front / Google Map / Backend / DB / Kakao Local API)

Front (React Native + Google Map 화면 표시)

Google Map이 화면에 렌더링됨

사용자가 지도를 이동/줌함

onRegionChangeComplete 시점에 현재 화면 bounds(NE/SW) 를 얻음

Front → Backend (현재 화면 기준 조회 요청)

Front가 Backend에 요청:
GET /api/places/gyms?swLat&swLng&neLat&neLng&q=헬스장

(과호출 방지) Front에서 debounce 적용

Backend → Kakao Local API (실시간 장소 검색)

Backend가 Kakao Local API에 rect(bounding box) 로 검색 요청

결과가 많으면 최대 45개(3페이지) 정도까지만 가져오고, 더 넓으면 “줌인 유도”

Backend (응답 정리 + 짧은 캐시 선택)

Kakao 응답을 앱에서 쓰기 좋은 형태로 변환 (id, name, lat/lng, address 등)

같은 bounds 요청이 반복되면 짧은 TTL 캐시(분 단위) 로 비용/속도 최적화(선택)

Backend → Front (지도에 뿌릴 데이터 반환)

Front로 반환:

places[] (마커 찍을 목록)

count (현재 화면 내 표시 가능한 개수 = places.length)

Front (Google Map에 표시)

받은 places[]를 Google Map에 마커/리스트/바텀시트로 표시

상단에 “현재 화면에 N개” 같은 UI 표시

“등록” 흐름 (사용자 저장/즐겨찾기 등)

Front (사용자가 특정 체육관 선택 → 등록 버튼)

선택한 place의 kakaoPlaceId + 사용자 메모/태그/즐겨찾기 상태 등을 준비

Front → Backend (등록 요청)

POST /api/gyms/register

body: { type: "KAKAO", kakaoPlaceId, displayName, note, tags... }

Backend → DB (참조 + 사용자 메타 저장)

DB에는 kakaoPlaceId(참조키) 와 우리 서비스 사용자 데이터(메모/태그/즐겨찾기 등) 만 저장

(선택) 중복 등록 방지: (userId, kakaoPlaceId) unique

Front (내 등록 목록/즐겨찾기 UI 반영)

등록 성공 응답 후 UI 업데이트

이후 “내 체육관 목록”은 Backend가 DB에서 조회해서 제공

요약 그림(텍스트)

지도 표시:
Front(Google Map) → bounds → Backend → Kakao Local API → places → Front → 마커 표시

체육관 등록:
Front(선택) → Backend 등록 API → DB(kakaoPlaceId + user meta 저장) → Front(내 목록 갱신)