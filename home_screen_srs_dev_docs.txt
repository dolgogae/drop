홈 화면 설계 문서 묶음 (SRS 중심)
Gym Map App | v0.1 | 2025-12-13 | Owner: 오시훈
================================================================================

1. 문서 개요
--------------------------------------------------------------------------------
* 목적:
  이 문서는 Gym Map App의 '홈 화면(Home)'만을 대상으로 요구사항(SRS)과 개발에 필요한 부가 문서(UX/UI 명세, API 계약, NFR, 테스트/수용 기준, 분석 이벤트, 릴리스 체크리스트)를 하나로 정리한다.
* 범위:
  포함: 홈 화면 UI/UX, 홈 데이터 로딩, 권한/오류/빈 상태, 내 체육관 미리보기, 등록 CTA, 홈 요약(근처 개수) 표시.
  제외: 지도 탐색, 장소 상세, 등록 플로우, 결제/구독, 관리자 기능.
* 대상 독자:
  프론트엔드(React Native), 백엔드(Spring), QA, 디자이너/PO, 운영 담당자
* 용어:
  본 문서의 '체육관'은 사용자가 탐색/등록 대상으로 삼는 장소(헬스장/피트니스/체육관 등)를 의미한다.

2. 핵심 목표 및 원칙
--------------------------------------------------------------------------------
* 제품 한 줄 정의:
  사용자가 '근처에 체육관이 얼마나 있는지'를 빠르게 파악하고, 자주 가는 체육관을 등록/관리로 바로 이어지게 하는 앱.
* 홈 화면 목표:
  앱 실행 후 3초 이내에: (1) 근처 요약을 보여주고 (2) 지도/내 체육관/등록으로 즉시 이동 가능하게 한다.
* UI 원칙:
  최대한 심플: 홈에서는 '핵심 숫자 + 최소 텍스트 + 1차 행동(CTA)'만 노출한다. 메모/주소/태그 등 상세 정보는 탭 후에만 노출(Progressive Disclosure).
* UX 원칙:
  학습이 쉬운 제스처: 탭을 기본으로 하고, 스와이프는 보조로 사용한다. OS 기본 제스처(뒤로가기 등)를 방해하지 않는다.

3. 사용자/시나리오
--------------------------------------------------------------------------------
* 사용자 유형:
  U1: 신규 사용자(내 체육관 0개), U2: 재방문 사용자(즐겨찾기/최근 사용 존재), U3: 위치 권한 거부 사용자
* 대표 시나리오 S1:
  앱 실행 → 홈에서 '근처 체육관 N개' 확인 → '지도에서 보기' 탭
* 대표 시나리오 S2:
  앱 실행 → '내 체육관' 카드에서 즐겨찾기 선택 → 상세로 이동(메모는 상세에서 펼침)
* 대표 시나리오 S3:
  앱 실행 → 홈의 '+' 등록 CTA 탭 → 등록 플로우 진입
* 대표 시나리오 S4:
  위치 권한 없음 → 홈에서 권한 안내 → '권한 허용' 또는 '주소로 찾기(대체)'로 진행

4. 정보구조(IA) 및 내비게이션
--------------------------------------------------------------------------------
* 탭 구조 권장:
  Bottom Tab: [홈] [지도] [내 체육관] (선택: [설정]). 등록은 전역 FAB(+)로 제공.
* 홈에서 가능한 이동:
  A) 지도에서 보기 → 지도 탭
  B) 내 체육관 카드 탭 → 체육관 상세
  C) 등록 CTA 탭 → 등록 플로우
  D) (선택) 내 체육관 '더보기' → 내 체육관 리스트

5. 홈 화면 UI 명세
--------------------------------------------------------------------------------
* 레이아웃 구성(상단→하단):
  1) 근처 요약 카드(Primary)
  2) 내 체육관 미리보기(최대 5개, 가로 스크롤)
  3) 전역 등록 CTA(FAB 또는 하단 고정 버튼)
* 근처 요약 카드:
  - 주요 텍스트: '근처 체육관 {N}개'
  - 보조 텍스트(선택): '현재 위치 기준' 또는 '마지막으로 본 위치'
  - 행동: [지도에서 보기] 버튼 + 카드 전체 탭 가능
* 내 체육관 미리보기:
  - 카드에 기본 표시: 이름 + 즐겨찾기 표시(선택)
  - 숨김(기본): 메모/주소/태그/전화
  - 탭 동작: 체육관 상세로 이동 후 '메모' 섹션을 접힌 상태로 제공
* 등록 CTA:
  - 위치: 홈 어디서든 한 손으로 접근 가능한 위치(FAB 권장)
  - 텍스트: '+ 등록'
  - 탭: 등록 플로우 진입(카카오에서 선택 / 직접 등록)
* 타이포/간격 가이드:
  - 한 화면에 동시에 보여주는 정보 덩어리 3개 이하
  - 텍스트는 2줄 이상 길어지지 않게(줄임표)
  - 버튼은 1차 CTA 1개만 강조

6. 홈 화면 상태(State) 및 동작
--------------------------------------------------------------------------------
* 로딩:
  스켈레톤(요약 카드 1 + 미리보기 리스트 1). 1.5초 이상이면 로딩 텍스트 대신 스켈레톤 유지.
* 성공:
  N/미리보기 목록 렌더. 데이터 갱신은 앱 포그라운드 복귀 시 1회.
* 빈 상태(내 체육관 0):
  '아직 등록된 체육관이 없어요' 문구 + [등록] CTA를 더 강하게 노출.
* 권한 없음(위치):
  권한 안내 카드 + [권한 허용] + [주소로 찾기(대체)] 제공.
* 네트워크 오류:
  요약 카드 영역에 '다시 시도' 버튼 1개. 상세 오류 코드는 로그/분석 이벤트로만 기록.
* 오프라인:
  마지막 성공 데이터가 있으면 캐시 표시 + 상단에 '오프라인' 배지(작게). 없으면 오류 상태로 처리.

7. 기능 요구사항(SRS) - 홈 화면
--------------------------------------------------------------------------------
* FR-1 근처 요약 표시:
  홈은 근처 요약(근처 체육관 개수 N)을 표시해야 한다.
* FR-2 지도 이동:
  사용자가 '지도에서 보기'를 탭하면 지도 화면으로 이동해야 한다.
* FR-3 내 체육관 미리보기:
  홈은 사용자 계정에 연결된 '내 체육관'을 최대 5개까지 미리보기로 보여야 한다.
* FR-4 상세 정보는 탭 후 노출:
  홈에서는 메모/주소/태그를 기본으로 노출하지 않으며, 체육관 상세 화면에서 탭(펼치기)으로 노출해야 한다.
* FR-5 등록 진입:
  홈에서 언제든 1회 탭으로 등록 플로우에 진입할 수 있어야 한다.
* FR-6 권한 처리:
  위치 권한이 없으면 홈에서 권한 요청/대체 경로를 제공해야 한다.
* FR-7 오류 복구:
  네트워크 오류 시 홈은 재시도 경로를 제공해야 한다.
* FR-8 접근성:
  동적 글꼴 크기/스크린리더에서 핵심 정보(근처 개수, 등록 버튼)를 읽을 수 있어야 한다.

8. 비기능 요구사항(NFR)
--------------------------------------------------------------------------------
* 성능:
  홈 API 응답 p95 < 300ms(캐시 히트 기준), 앱 홈 최초 렌더 p95 < 2.0s 목표.
* 안정성:
  홈은 외부 지도/장소 API에 직접 의존하지 않는다(홈은 summary 중심).
* 보안:
  내 체육관 미리보기는 인증이 필요하며, 토큰 만료 시 로그인으로 유도한다.
* 프라이버시:
  정확한 위치 좌표는 홈 화면에서 서버로 전송하지 않는다. 필요 시 그리드/타일 수준으로 스냅(예: 500m)하여 전송한다.
* 관측성:
  홈 진입/CTA 클릭/오류/권한 상태를 분석 이벤트로 수집한다.

9. API 계약 (Backend - Spring)
--------------------------------------------------------------------------------
* GET /api/home/summary:
  설명: 홈 화면에 필요한 최소 데이터를 반환
  인증: 필요(Bearer Token)
  Query: (선택) locationMode=current|last, latGrid, lngGrid
  응답(JSON):
  {
    "nearbyGymCount": 12,
    "nearbyBasis": "current",  // current | last
    "myGymsPreview": [
      {"gymId": 101, "name": "헬스장 A", "isFavorite": true},
      {"gymId": 102, "name": "피트니스 B", "isFavorite": false}
    ],
    "hasMoreMyGyms": true
  }
  
* 에러 응답:
  - 401: 인증 필요/만료
  - 403: 접근 불가
  - 5xx: 서버 오류(클라이언트는 재시도 UI)
  
* 캐시 전략(권장):
  nearbyGymCount는 (latGrid,lngGrid,locationMode) 단위로 Redis 캐시 TTL 5~15분.

10. 프론트엔드 동작 규칙 (React Native)
--------------------------------------------------------------------------------
* 데이터 로딩 타이밍:
  앱 실행 후 홈 진입 시 1회 호출. 앱 포그라운드 복귀 시(예: 10분 이상 경과) 재호출.
* 리렌더 최소화:
  home summary 응답을 하나의 상태로 관리하고, 카드/리스트는 memoization 적용.
* 제스처/탭:
  홈에서는 스와이프 액션을 기본 제공하지 않는다(심플 유지). 내 체육관 리스트는 가로 스크롤만 허용.
* 메모 노출:
  홈에서 메모를 노출하지 않는다. 상세 화면에서 '메모 펼치기' 토글로 표시.
* 오류 표시:
  단일 재시도 버튼 + 토스트(선택). 복잡한 오류 설명은 숨김.

11. Analytics 이벤트 정의
--------------------------------------------------------------------------------
* 필수 이벤트:
  - home_view
  - home_tap_go_map
  - home_tap_register
  - home_tap_my_gym_card
  - home_permission_prompt_shown
  - home_permission_granted / home_permission_denied
  - home_api_error
  
* 이벤트 공통 속성:
  app_version, platform(ios|android), user_state(new|returning), locationMode(current|last)

12. 테스트/수용 기준 (QA)
--------------------------------------------------------------------------------
* AC-1 심플 UI:
  홈에는 (요약 카드/내 체육관/등록 CTA) 3개 영역만 기본 노출되고, 메모는 노출되지 않는다.
* AC-2 권한:
  위치 권한 거부 시 홈에서 권한 요청/대체 경로가 제공된다.
* AC-3 내 체육관 0개:
  빈 상태 문구와 등록 CTA가 정상 노출된다.
* AC-4 오류 복구:
  네트워크 오류 시 재시도 버튼이 동작하며, 성공 시 정상 상태로 복구된다.
* AC-5 접근성:
  스크린리더에서 '근처 체육관 N개'와 '등록'이 읽히고, 버튼 포커스 이동이 가능하다.
* 테스트 케이스(샘플):
  - TC-HOME-001: 정상 로딩
  - TC-HOME-002: 401 토큰 만료
  - TC-HOME-003: 위치 권한 거부
  - TC-HOME-004: 내 체육관 0개
  - TC-HOME-005: 네트워크 타임아웃
  

13. 릴리스 체크리스트 (Home)
--------------------------------------------------------------------------------
* 기능:
  홈 진입/탭 이동/등록 진입/빈 상태/권한/오류 모두 통과
* 성능:
  p95 목표 충족(로깅/모니터링 확인)
* 분석:
  필수 이벤트 누락 없음(샘플링 확인)
* 보안:
  인증 필요 엔드포인트 보호, 민감 데이터(정밀 위치) 미전송 확인
* 스토어 준비:
  스크린샷/설명문에 과장 문구 없이 기능 설명

14. 오픈 이슈/결정 필요 항목
--------------------------------------------------------------------------------
* D-1 근처 기준:
  근처 요약의 기준을 '현재 위치'로 할지 '마지막으로 본 지도 위치'로 할지 결정 필요.
* D-2 그리드 단위:
  프라이버시/정확도 균형을 위한 grid size(예: 200m/500m/1km) 결정 필요.
* D-3 미리보기 정렬:
  내 체육관 미리보기 정렬: 즐겨찾기 우선 vs 최근 방문/조회 우선.
* D-4 FAB 위치:
  iOS/Android 공통 FAB 위치 및 안전영역(insets) 반영 정책.

15. 부록 - Glossary
--------------------------------------------------------------------------------
* Home Summary:
  홈 화면을 구성하기 위한 최소 데이터 묶음.
* Progressive Disclosure:
  처음에는 핵심만 보여주고, 사용자의 의도적 액션(탭 등) 후 상세를 보여주는 UI 기법.
* My Gyms:
  사용자가 등록/즐겨찾기한 체육관 목록(앱 고유 데이터).
* lat/lng grid:
  정밀 위치 대신 격자화된 좌표로 서버에 전달하는 방식(프라이버시 향상).